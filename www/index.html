<html>
<head>
    <title>Dynamique des Territoires</title>

    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css"
          integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
    <link rel="stylesheet" type="text/css" href="css/nouislider.min.css">

    <link rel="stylesheet" type="text/css" href="css/app.css" id="dynamic_css">
    <meta charset="UTF-8">
</head>
<body id="page_body">


<div id="debug" style="position: fixed; margin-top: 20px; margin-left: 30%; z-index: 2000000000;">
    <button onclick="swapTo('login')">Connexion</button>
    <button onclick="swapTo('accueil')">Accueil</button>
    <button onclick="swapTo('create')">Création Compte</button>
    <button onclick="swapTo('app')">App</button>
</div>


<div id="accueil" style="">
    <main class="container">
        <div class="row align-items-center">
            <div class="offset-6 col-6">
                <h1>Dynamique des territoires</h1>
                <p>Cette application vous permet de comparer des communes entres elles. A l'aide de filtres, vous
                    pourrez constituer une sélection de communes. Cela permettra de calculer diverses statistiques
                    afin de vous renseigner dans votre prise de décision.</p>
                <div class="btn-group block" role="group">
                    <a class="btn btn-primary" onclick="swapTo('login')" role="button">Connexion</a>
                    <a class="btn btn-secondary" onclick="swapTo('create')" role="button">S'inscrire</a>
                </div>
            </div>
        </div>
    </main>
</div>


<div id="login" hidden>
    <nav class="navbar navbar-default fixed-top">
        <a class="btn btn-secondary" onclick="swapTo('acceuil')" role="button">Retour</a>
    </nav>
    <div class="container">
        <main class="row align-items-center">
            <div class="col-4 offset-4">
                <h1>Connexion</h1>
                <div class="form-group">
                    <label for="login_adresseEmail">Adresse Email</label>
                    <input type="email" class="form-control" id="login_adresseEmail" placeholder="nom@exemple.com">
                </div>
                <div class="form-group">
                    <label for="login_motDePasse">Mot de passe</label>
                    <input type="password" class="form-control" id="login_motDePasse" minlength="4"
                           placeholder="mot de passe">
                </div>
                <div class="form-check">
                    <input type="checkbox" class="form-check-input" id="connectionPersistent" checked>
                    <label class="form-check-label" for="connectionPersistent">Se souvenir de moi</label>
                </div>
                <button onclick="login_Connecter()" class="btn btn-primary btn-block mt-3">Se connecter</button>
            </div>
        </main>
    </div>
</div>


<div id="create" hidden>
    <nav class="navbar navbar-default fixed-top">
        <a class="btn btn-secondary" onclick="swapTo('acceuil')" role="button">Retour</a>
    </nav>
    <main class="row align-items-center">
        <div class="col-4 offset-4">
            <h1>Inscription</h1>
            <div class="form-group">
                <label for="create_nom">Nom</label>
                <input type="text" class="form-control" id="create_nom"placeholder="Nom">
            </div>
            <div class="form-group">
                <label for="create_prenom">Pr&eacute;nom</label>
                <input type="text" class="form-control" id="create_prenom" placeholder="Pr&eacute;nom">
            </div>
            <div class="form-group">
                <label for="create_adresseEmail">Adresse Email</label>
                <input type="email" class="form-control" id="create_adresseEmail"
                       placeholder="Adresse email">
            </div>
            <div class="form-group">
                <label for="create_motDePasse">Mot de passe</label>
                <input type="password" class="form-control" id="create_motDePasse"
                       placeholder="Mot de passe" minlength="4" title="Taille > 4 Minimum">
            </div>
            <div class="form-group" id="create_mdpZone2">
                <label for="create_confirmerMotDePasse">Confirmer mot de passe</label>
                <input type="password" class="form-control" id="create_confirmerMotDePasse"
                       placeholder="Confirmer Mot de passe" minlength="4">
            </div>
            <div id="create_error" style="color: red;"></div>
            <button class="btn btn-primary btn-block mt-3" onclick="create_Submit()">S'inscrire</button>
        </div>
    </main>
</div>


<div id="app" hidden>
    <div id="app_openNav">
        <span onclick="toggleNav()">&#9776; Menu</span>
    </div>

    <div id="mySidenav" class="sidenav">
        <a class="closebtn" onclick="toggleNav()">&times;</a>

        <div class="filters" id="app_filters">
            <div class="form-group" data-toggle="tooltip" title="Faites glisser les curseurs ci-contre le long de la barre pour d&eacute;finir le nombre minimum et maximum d'habitants dans les villes qui vous int&eacute;ressent.">
                <label>Population</label>
                <div id="slider-population" class="sliders"></div>
                De <span id="sl_pop_min">0</span> à <span id="sl_pop_max">0</span>
            </div>
            <div class="form-group" data-toggle="tooltip" title="Faites glisser les curseurs ci-contre le long de la barre pour d&eacute;finir le nombre minimum et maximum d'étudiants dans les villes qui vous int&eacute;ressent.">
                <label>Nombre d'étudiants</label>
                <div id="slider-etudiants" class="sliders"></div>
                De <span id="sl_etu_min">0</span> à <span id="sl_etu_max">0</span>
            </div>
            <div class="form-group" data-toggle="tooltip" title="Faites glisser les curseurs ci-contre le long de la barre pour d&eacute;finir le nombre minimum et maximum de personnes actives dans les villes qui vous int&eacute;ressent.">
                <label>Nombre d'actifs</label>
                <div id="slider-actifs" class="sliders"></div>
                De <span id="sl_act_min">0</span> à <span id="sl_act_max">0</span>
            </div>
            <div class="form-group" data-toggle="tooltip" title="Faites glisser les curseurs ci-contre le long de la barre pour d&eacute;finir le nombre minimum et maximum de b&acirc;timents des services publiques dans les villes qui vous int&eacute;ressent.">
                <label>Nombre d'établissements publiques</label>
                <div id="slider-etablissements" class="sliders"></div>
                De <span id="sl_eta_min">0</span> à <span id="sl_eta_max">0</span>
            </div>
            <div class="form-group" data-toggle="tooltip" title="Cochez l'une des options ci-contre pour d&eacute;finir la mobilit&eacute; type des habitants des villes qui vous int&eacute;ressent.">
                <label>Mobilit&eacute; de la population</label>
                <div class="form-check">
                    <div class="form-row">
                        <input type="radio" name="mobility" class="form-check-input" id="anyMobility" onchange="filter_update()" checked>
                        <label class="form-check-label" for="anyMobility">N'importe quel type de mobilit&eacute;</label>
                    </div>
                    <div class="form-row">
                        <input type="radio" name="mobility" class="form-check-input" onchange="filter_update()" id="populationSedentaire">
                        <label class="form-check-label" for="populationSedentaire">Population sédentaire</label>
                    </div>
                    <div class="form-row">
                        <input type="radio" name="mobility" class="form-check-input" onchange="filter_update()" id="populationMobile">
                        <label class="form-check-label" for="populationMobile">Population mobile</label>
                    </div>
                </div>
            </div>
            <div class="form-group" data-toggle="tooltip" title="S&eacute;lectionnez dans le menu d&eacute;roulant ci-contre le type d'environnement démographique des villes qui vous int&eacute;ressent.">
                <label for="demographic_environment">Environnement d&eacute;mographique</label>
                <select name="demographic_environment" id="demographic_environment" class="form-control" onchange="filter_update()">
                    <option value="anyDemographicEnvironment">N'importe quel environnement démographique</option>
                    <option value="bassinIndustrielCroissant">Bassin industriel en croissance démographique</option>
                    <option value="bassinResidentielCroissant">Bassin résidentiel en croissance démographique</option>
                    <option value="bassinUrbainCroissant">Bassin urbain en croissance démographique</option>
                    <option value="bassinDiversifieCroissant">Bassin diversifié en croissance démographique</option>
                    <option value="bassinAgroalimentaireCroissant">Bassin agroalimentaire en croissance démographique</option>
                    <option value="bassinResidentielDeclin">Bassin résidentiel en déclin démographique</option>
                    <option value="bassinDiversifieDeclin">Bassin diversifié en déclin démographique</option>
                </select>
            </div>
        </div>

        <div id="app_side_bottom">
        <button type="button" class="btn btn-success" id="app_refresh" onclick="filterRequest()">Filtrer et comparer</button>
            <button type="button" class="btn btn-primary" id="app_upload" onclick="browseCsvFile()">Charger CSV</button>
            <input type="file" accept=".csv" style="display: none" id="csv_file_input" oninput="loadCsv()">
        </div>
    </div>

    <div class="map" id="map"></div>

    <section class="right">
        <div id="comparator" class="container">
            <form class="row" action="#">
                <div class="input-group col-4">
                    <div class="input-group-prepend">
                        <div class="input-group-text">Ville A</div>
                    </div>
                    <input type="text" oninput="onModifA()" list="listCommunes" class="form-control" id="inputCommuneA" placeholder="Nom commune A">
                </div>
                <div class="input-group col-4">
                    <div class="input-group-prepend">
                        <div class="input-group-text">Ville B</div>
                    </div>
                    <input type="text" list="listCommunes" class="form-control" id="inputCommuneB" oninput="onModifB()" placeholder="Nom commune B">
                </div>
                <div class="input-group col-4">
                <div>
                    <input type="button" class="btn btn-primary" OnClick="javascript:window.location.reload()" value="Déconnexion"/>
                </div>
              </div>
                <datalist id="listCommunes">
                </datalist>
            </form>
            <div id="comparatorResult">
                <div class="text-center">Entrez le nom des deux communes que vous souhaitez comparer.</div>
            </div>
        </div>
        <div id="statistics" role="tabpanel">
            <ul class="nav nav-tabs" role="tablist">
                <li class="nav-item">
                    <a class="nav-link active" data-toggle="tab" role="tab" href="#tabpane-1">Tab 1</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" data-toggle="tab" role="tab" href="#tabpane-2">Tab 2</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" data-toggle="tab" role="tab" href="#tabpane-3">Tab 3</a>
                </li>
            </ul>
            <div class="tab-content">
                <div class="tab-pane fade active show" id="tabpane-1" role="tabpanel">
                    <canvas id="chart_1" height="100%"></canvas>
                </div>
                <div class="tab-pane fade" id="tabpane-2" role="tabpanel">
                    <canvas id="chart_2"></canvas>
                </div>
                <div class="tab-pane fade" id="tabpane-3" role="tabpanel">
                    <canvas id="chart_3"></canvas>
                </div>
            </div>
        </div>
    </section>
</div>
<template id="comparatorResultTemplate">
    <table class="table table-bordered table-striped text-center">
        <thead>
            <tr>
                <th>&nbsp;</th>
                <th data-content="$data.comm1.nom"></th>
                <th data-content="$data.comm2.nom"></th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <th>d&eacute;partement</th>
                <td data-content="$data.comm1.num_dep"></td>
                <td data-content="$data.comm2.num_dep"></td>
            </tr>
            <tr>
                <th>mobilit&eacute; des habitants</th>
                <td data-attr="'style': greenRedColor($data.comm1.fidelite === 'Pop Mobile')" data-content="'population ' + ($data.comm1.fidelite == 'Pop Mobile' ? 'mobile' : 's&eacute;dentaire')"></td>
                <td data-attr="'style': greenRedColor($data.comm2.fidelite === 'Pop Mobile')" data-content="'population ' + ($data.comm2.fidelite == 'Pop Mobile' ? 'mobile' : 's&eacute;dentaire')"></td>
            </tr>
            <tr>
                <th>environnement d&eacute;mographique</th>
                <td data-attr="'style': greenRedColor($data.comm1.evolution_pop === 'en croissance démographique')" data-content="$data.comm1.env_demo.toLowerCase() + '&nbsp;' + ($data.comm1.evolution_pop === 'en croissance démographique' ? '&#x2197;' : '&#x2198;')"></td>
                <td data-attr="'style': greenRedColor($data.comm2.evolution_pop === 'en croissance démographique')" data-content="$data.comm2.env_demo.toLowerCase() + '&nbsp;' + ($data.comm2.evolution_pop === 'en croissance démographique' ? '&#x2197;' : '&#x2198;')"></td>
            </tr>
        </tbody>
    </table>
</template>
<script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"
        integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl"
        crossorigin="anonymous"></script>
<script src="https://code.highcharts.com/highcharts.js"></script>
<script src="https://code.highcharts.com/maps/modules/map.js"></script>
<script src="https://code.highcharts.com/mapdata/countries/fr/fr-all.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.4.0/Chart.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/wnumb/1.1.0/wNumb.min.js"></script>
<script type="application/javascript" src="js/nouislider.min.js"></script>

<script type="application/javascript" src="js/logic.js"></script>
</body>
</html>
